---
const { video } = Astro.props;
const origin = Astro.site;
const videoUrl = new URL(video);
videoUrl.searchParams.set('controls', '0');
videoUrl.searchParams.set('rel', '0');
videoUrl.searchParams.set('enablejsapi', '1');
videoUrl.searchParams.set('loop', '1');

if(origin) {
    videoUrl.searchParams.set('origin', origin.toString());
}
---
<iframe
    width='100%'
    height="100%"
    class="absolute inset-0"
    data-video
    id={videoUrl.toString()}
    src={videoUrl.toString()}
    title="YouTube video player"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    referrerpolicy="strict-origin-when-cross-origin"
/>
<script>
    // const videos = document.querySelectorAll('[data-video]');
    const tag = document.createElement('script');
    tag.id = 'iframe-demo';
    tag.src = 'https://www.youtube.com/iframe_api';
    document.body.appendChild(tag);
</script>